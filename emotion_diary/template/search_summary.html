{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Search Memories | Life Diary</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: "Poppins", sans-serif;
      background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
      color: #e5e5e5;
      min-height: 100vh;
    }
    .fade-in {
      animation: fadeIn 1s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .memory-card {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 1rem;
      padding: 1.2rem;
      margin-top: 1rem;
      transition: all 0.3s ease;
    }
    .memory-card:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: scale(1.02);
    }
    .emotion-tag {
      display: inline-block;
      font-size: 0.8rem;
      padding: 0.2rem 0.6rem;
      border-radius: 0.5rem;
      text-transform: capitalize;
    }
    .emotion-joy { background: #22c55e33; color: #4ade80; }
    .emotion-sadness { background: #3b82f633; color: #60a5fa; }
    .emotion-fear { background: #f59e0b33; color: #fbbf24; }
    .emotion-anger { background: #ef444433; color: #f87171; }
    .emotion-love { background: #ec489933; color: #f472b6; }
    .emotion-neutral { background: #6b728033; color: #d1d5db; }
  </style>
</head>

<body class="fade-in">

  

  <section class="max-w-3xl mx-auto px-6 py-10">
    <h1 class="text-3xl font-semibold mb-6 text-center text-indigo-300">üîç Search Your Memories</h1>

    <!-- Search Box -->
    <form method="get" action="" class="flex flex-col sm:flex-row items-center justify-center gap-3 mb-8">
      <input type="text" name="q" value="{{ query }}" placeholder="Type your memory or feeling..."
             class="w-full sm:w-3/4 px-4 py-3 rounded-xl bg-white/10 border border-gray-500 text-white focus:ring-2 focus:ring-indigo-400 outline-none">
      <button type="submit"
              class="px-6 py-3 bg-indigo-500 hover:bg-indigo-600 rounded-xl font-semibold text-white transition">
        Search
      </button>
    </form>

    <!-- AI Summary -->
    {% if summary %}
    <div class="bg-white/10 border border-indigo-500/30 rounded-2xl p-6 shadow-lg mb-10 fade-in">
      <h2 class="text-xl font-semibold text-indigo-300 mb-3">üß† AI Summary</h2>
      <p class="text-gray-200 leading-relaxed">{{ summary }}</p>
    </div>
    {% endif %}

    <!-- Related Memories -->
    <h2 class="text-lg text-gray-300 mb-3">üóìÔ∏è Related Entries</h2>
    {% for score, m in matches %}
    <div class="memory-card fade-in">
      <p class="text-gray-100 mb-2">{{ m.text_content }}</p>
      <div class="flex justify-between items-center text-sm text-gray-400">
        <span>{{ m.created_at|date:"F j, Y" }}</span>
        <span class="emotion-tag emotion-{{ m.emotion_label|default:'neutral' }}">
          {{ m.emotion_label|default:"neutral" }}
        </span>
      </div>
    </div>
    {% empty %}
      {% if query %}
        <p class="text-center text-gray-400 mt-8">No related entries found.</p>
      {% endif %}
    {% endfor %}
  </section>

</body>
</html>
